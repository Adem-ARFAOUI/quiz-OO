<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Chatbot Statistiques</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body
    class="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-600 min-h-screen flex items-center justify-center p-4">

    <div class="chatbot bg-white shadow-2xl rounded-2xl w-full max-w-md flex flex-col overflow-hidden">

        <!-- Titre -->
        <h1 class="text-xl sm:text-2xl font-bold text-center text-indigo-600 bg-gray-100 py-4 border-b">
             Chatbot Statistiques du Quiz OO
        </h1>

        <!-- Zone de chat -->
        <div id="chat-area" class="flex-1 p-4 overflow-y-auto space-y-3 text-sm sm:text-base">
            <!-- Les messages viendront ici dynamiquement -->
        </div>

        <!-- Zone d'entrÃ©e -->
        <div class="flex items-center gap-2 p-4 border-t bg-gray-50">
            <input type="text" id="user-input" placeholder="Posez une question... (ex: pourcentage, moyenne)"
                class="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 text-sm sm:text-base">
            <button onclick="envoyer()"
                class="px-4 py-2 bg-indigo-600 text-white rounded-lg shadow-md hover:bg-indigo-700 active:scale-95 transition-transform">
                Envoyer
            </button>
        </div>

        <script>
            async function getStats() {
                let res = await fetch("https://quiz-oo.onrender.com/api/stats"); // âš¡ appelle ton backend
                return await res.json();
            }

            async function chatbot(question) {
                let stats = await getStats();

                if (stats.message) return " " + stats.message;

                if (question.includes("pourcentage")) {
                    return `ðŸ“Š ${stats.pourcentageCompris}% des Ã©tudiants ont compris le cours.`;
                } else if (question.includes("moyenne")) {
                    return `ðŸ“ˆ La moyenne gÃ©nÃ©rale est ${stats.moyenne}%.`;
                } else if (question.includes("combien")) {
                    return `ðŸ‘¥ ${stats.total} Ã©tudiants ont participÃ© au quiz.`;
                } else {
                    return " Je peux rÃ©pondre sur 'pourcentage', 'moyenne' ou 'combien'.";
                }
            }

            async function envoyer() {
                let input = document.getElementById("user-input").value;
                if (!input) return;

                let chatArea = document.getElementById("chat-area");
                chatArea.innerHTML += `<p class="user"><b>Vous :</b> ${input}</p>`;

                let reponse = await chatbot(input.toLowerCase());
                chatArea.innerHTML += `<p class="bot"><b>Bot :</b> ${reponse}</p>`;

                document.getElementById("user-input").value = "";
                chatArea.scrollTop = chatArea.scrollHeight;
            }
        </script>

</body>


</html>
